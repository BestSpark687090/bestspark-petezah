---
/**
 * Google Tag Manager Analytics Component
 * Injects GTM script in head and noscript fallback in body
 */

/**
 * Props for the Analytics component
 */
interface Props {
  /** Location to inject the analytics code: 'head' or 'body' */
  location: 'head' | 'body';
}

const { location }: Props = Astro.props;
---

{location === "head" && (
  <script is:inline>
  (function (w, d, s, l, i) {
    w[l] = w[l] || [];
    w[l].push({ 'gtm.start': new Date().getTime(), 'event': 'gtm.js' });
    var f = d.getElementsByTagName(s)[0],
      j = d.createElement(s),
      dl = l != 'dataLayer' ? '&l=' + l : '';
    j.async = true;
    j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
    f.parentNode.insertBefore(j, f);
  })(window, document, 'script', 'dataLayer', 'GTM-WPH7NCG4');
  </script>
)}

{location === "body" && (
  <noscript>
    <iframe
      src="https://www.googletagmanager.com/ns.html?id=GTM-WPH7NCG4"
      height="0"
      width="0"
      style="display:none;visibility:hidden"
    ></iframe>
  </noscript>
)}
